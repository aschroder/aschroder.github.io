<!doctype html>
<html lang="en-US">

<!-- Mirrored from www.aschroder.com/2010/08/magento-and-google-analytics-use-first-touch-tracking-to-see-how-your-customers-first-visit-your-store/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 30 Aug 2023 22:34:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="../../../xmlrpc.php">

<title>Magento and Google Analytics â€“ Use &#039;First Touch&#039; Tracking To See How Your Customers First Visit Your Store | ASchroder.com</title>

<!-- All in One SEO Pack 2.4.2 by Michael Torbert of Semper Fi Web Design[289,442] -->
<meta name="description"  content="At the recent Auckland Magento Meetup I had the privilege of seeing Mark Hammersley&#039;s presentation on email marketing - Mark&#039;s a fascinating guy and a real" />

<!-- /all in one seo pack -->
<link rel='dns-prefetch' href='http://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="ASchroder.com &raquo; Feed" href="../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="ASchroder.com &raquo; Comments Feed" href="../../../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="ASchroder.com &raquo; Magento and Google Analytics &#8211; Use &#8216;First Touch&#8217; Tracking To See How Your Customers First Visit Your Store Comments Feed" href="feed/index.html" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v6.2.4 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
		var disableStr = 'ga-disable-UA-6477134-1';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','http://www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-6477134-1', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('send','pageview');
</script>
<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.aschroder.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.15"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='yarppWidgetCss-css'  href='../../../wp-content/plugins/yet-another-related-posts-plugin/style/widget101e.css?ver=4.8.15' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='../../../wp-content/plugins/wp-syntax/css/wp-syntax4963.css?ver=1.1' type='text/css' media='all' />
<link rel='stylesheet' id='storefront-style-css'  href='../../../../cdn.aschroder.com/wp-content/themes/storefront/style5bf8.css?ver=2.2.5' type='text/css' media='all' />
<style id='storefront-style-inline-css' type='text/css'>

			.main-navigation ul li a,
			.site-title a,
			ul.menu li a,
			.site-branding h1 a,
			.site-footer .storefront-handheld-footer-bar a:not(.button),
			button.menu-toggle,
			button.menu-toggle:hover {
				color: #333333;
			}

			button.menu-toggle,
			button.menu-toggle:hover {
				border-color: #333333;
			}

			.main-navigation ul li a:hover,
			.main-navigation ul li:hover > a,
			.site-title a:hover,
			a.cart-contents:hover,
			.site-header-cart .widget_shopping_cart a:hover,
			.site-header-cart:hover > li > a,
			.site-header ul.menu li.current-menu-item > a {
				color: #838383;
			}

			table th {
				background-color: #f8f8f8;
			}

			table tbody td {
				background-color: #fdfdfd;
			}

			table tbody tr:nth-child(2n) td,
			fieldset,
			fieldset legend {
				background-color: #fbfbfb;
			}

			.site-header,
			.secondary-navigation ul ul,
			.main-navigation ul.menu > li.menu-item-has-children:after,
			.secondary-navigation ul.menu ul,
			.storefront-handheld-footer-bar,
			.storefront-handheld-footer-bar ul li > a,
			.storefront-handheld-footer-bar ul li.search .site-search,
			button.menu-toggle,
			button.menu-toggle:hover {
				background-color: #ffffff;
			}

			p.site-description,
			.site-header,
			.storefront-handheld-footer-bar {
				color: #6d6d6d;
			}

			.storefront-handheld-footer-bar ul li.cart .count,
			button.menu-toggle:after,
			button.menu-toggle:before,
			button.menu-toggle span:before {
				background-color: #333333;
			}

			.storefront-handheld-footer-bar ul li.cart .count {
				color: #ffffff;
			}

			.storefront-handheld-footer-bar ul li.cart .count {
				border-color: #ffffff;
			}

			h1, h2, h3, h4, h5, h6 {
				color: #333333;
			}

			.widget h1 {
				border-bottom-color: #333333;
			}

			body,
			.secondary-navigation a,
			.onsale,
			.pagination .page-numbers li .page-numbers:not(.current), .woocommerce-pagination .page-numbers li .page-numbers:not(.current) {
				color: #6d6d6d;
			}

			.widget-area .widget a,
			.hentry .entry-header .posted-on a,
			.hentry .entry-header .byline a {
				color: #9f9f9f;
			}

			a  {
				color: #0228d1;
			}

			a:focus,
			.button:focus,
			.button.alt:focus,
			.button.added_to_cart:focus,
			.button.wc-forward:focus,
			button:focus,
			input[type="button"]:focus,
			input[type="reset"]:focus,
			input[type="submit"]:focus {
				outline-color: #0228d1;
			}

			button, input[type="button"], input[type="reset"], input[type="submit"], .button, .added_to_cart, .widget a.button, .site-header-cart .widget_shopping_cart a.button {
				background-color: #eeeeee;
				border-color: #eeeeee;
				color: #333333;
			}

			button:hover, input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover, .button:hover, .added_to_cart:hover, .widget a.button:hover, .site-header-cart .widget_shopping_cart a.button:hover {
				background-color: #d5d5d5;
				border-color: #d5d5d5;
				color: #333333;
			}

			button.alt, input[type="button"].alt, input[type="reset"].alt, input[type="submit"].alt, .button.alt, .added_to_cart.alt, .widget-area .widget a.button.alt, .added_to_cart, .widget a.button.checkout {
				background-color: #333333;
				border-color: #333333;
				color: #ffffff;
			}

			button.alt:hover, input[type="button"].alt:hover, input[type="reset"].alt:hover, input[type="submit"].alt:hover, .button.alt:hover, .added_to_cart.alt:hover, .widget-area .widget a.button.alt:hover, .added_to_cart:hover, .widget a.button.checkout:hover {
				background-color: #1a1a1a;
				border-color: #1a1a1a;
				color: #ffffff;
			}

			.pagination .page-numbers li .page-numbers.current, .woocommerce-pagination .page-numbers li .page-numbers.current {
				background-color: #e6e6e6;
				color: #6d6d6d;
			}

			#comments .comment-list .comment-content .comment-text {
				background-color: #f8f8f8;
			}

			.site-footer {
				background-color: #f0f0f0;
				color: #6d6d6d;
			}

			.site-footer a:not(.button) {
				color: #333333;
			}

			.site-footer h1, .site-footer h2, .site-footer h3, .site-footer h4, .site-footer h5, .site-footer h6 {
				color: #333333;
			}

			#order_review {
				background-color: #ffffff;
			}

			#payment .payment_methods > li .payment_box,
			#payment .place-order {
				background-color: #fafafa;
			}

			#payment .payment_methods > li:not(.woocommerce-notice) {
				background-color: #f5f5f5;
			}

			#payment .payment_methods > li:not(.woocommerce-notice):hover {
				background-color: #f0f0f0;
			}

			@media screen and ( min-width: 768px ) {
				.secondary-navigation ul.menu a:hover {
					color: #868686;
				}

				.secondary-navigation ul.menu a {
					color: #6d6d6d;
				}

				.site-header-cart .widget_shopping_cart,
				.main-navigation ul.menu ul.sub-menu,
				.main-navigation ul.nav-menu ul.children {
					background-color: #f0f0f0;
				}

				.site-header-cart .widget_shopping_cart .buttons,
				.site-header-cart .widget_shopping_cart .total {
					background-color: #f5f5f5;
				}

				.site-header {
					border-bottom-color: #f0f0f0;
				}
			}
</style>
<link rel='stylesheet' id='storefront-icons-css'  href='../../../../cdn.aschroder.com/wp-content/themes/storefront/assets/sass/base/icons5bf8.css?ver=2.2.5' type='text/css' media='all' />
<link rel='stylesheet' id='storefront-fonts-css'  href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,300italic,400italic,600,700,900&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<script type='text/javascript' src='../../../../cdn.aschroder.com/wp-includes/js/jquery/jqueryb8ff.js?ver=1.12.4'></script>
<script type='text/javascript' src='../../../../cdn.aschroder.com/wp-includes/js/jquery/jquery-migrate.min330a.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='../../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Latest version of SMTP Pro Finally Uploaded to Magento Connect' href='../../07/latest-version-of-smtp-pro-finally-uploaded-to-magento-connect/index.html' />
<link rel='next' title='Improved Custom Magento Order Number Functionality for SetStartOrderNumber extension &#8211; v0.3' href='../improved-custom-magento-order-number-functionality-for-setstartordernumber-extension-v0-3/index.html' />
<meta name="generator" content="WordPress 4.8.15" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='../../../index9a38.html?p=957' />
<link rel="alternate" type="application/json+oembed" href="../../../wp-json/oembed/1.0/embed6669.json?url=http%3A%2F%2Fwww.aschroder.com%2F2010%2F08%2Fmagento-and-google-analytics-use-first-touch-tracking-to-see-how-your-customers-first-visit-your-store%2F" />
<link rel="alternate" type="text/xml+oembed" href="../../../wp-json/oembed/1.0/embed088e?url=http%3A%2F%2Fwww.aschroder.com%2F2010%2F08%2Fmagento-and-google-analytics-use-first-touch-tracking-to-see-how-your-customers-first-visit-your-store%2F&amp;format=xml" />
</head>

<body class="post-template-default single single-post postid-957 single-format-standard no-wc-breadcrumb storefront-full-width-content right-sidebar">


<div id="page" class="hfeed site">
	
	<header id="masthead" class="site-header" role="banner" style="">
		<div class="col-full">

					<a class="skip-link screen-reader-text" href="#site-navigation">Skip to navigation</a>
		<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
				<div class="site-branding">
			<div class="beta site-title"><a href="../../../index.html" rel="home">ASchroder.com</a></div><p class="site-description">Notes on Web Development</p>		</div>
		<div class="storefront-primary-navigation">		<nav id="site-navigation" class="main-navigation" role="navigation" aria-label="Primary Navigation">
		<button class="menu-toggle" aria-controls="site-navigation" aria-expanded="false"><span>Menu</span></button>
			<div class="primary-navigation"><ul id="menu-main-menu" class="menu"><li id="menu-item-1119" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1119"><a href="../../../index.html">Home</a></li>
<li id="menu-item-1118" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1118"><a href="../../../about/index.html">About</a></li>
<li id="menu-item-1872" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1872"><a href="../../../presentations/index.html">Presentations</a></li>
</ul></div><div class="handheld-navigation"><ul id="menu-main-menu-1" class="menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1119"><a href="../../../index.html">Home</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1118"><a href="../../../about/index.html">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1872"><a href="../../../presentations/index.html">Presentations</a></li>
</ul></div>		</nav><!-- #site-navigation -->
		</div>
		</div>
	</header><!-- #masthead -->

	
	<div id="content" class="site-content" tabindex="-1">
		<div class="col-full">

		
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
<div id="post-957" class="post-957 post type-post status-publish format-standard hentry category-magento category-web-development tag-first-touch-tracking tag-google-analytics tag-magento-visit-tracking">

			<header class="entry-header">
		<span class="posted-on">Posted on <a href="index.html" rel="bookmark"><time class="entry-date published" datetime="2010-08-04T16:33:02+00:00">August 4, 2010</time> <time class="updated" datetime="2010-08-11T14:35:28+00:00">August 11, 2010</time></a></span><h1 class="entry-title">Magento and Google Analytics &#8211; Use &#8216;First Touch&#8217; Tracking To See How Your Customers First Visit Your Store</h1>		</header><!-- .entry-header -->
				<aside class="entry-meta">
						<div class="author">
				<img alt='' src='http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' /><div class="label">Written by</div><a href="../../../author/admin/index.html" title="Posts by Ashley" rel="author">Ashley</a>			</div>
							<div class="cat-links">
					<div class="label">Posted in</div><a href="../../../category/magento/index.html" rel="category tag">Magento</a>, <a href="../../../category/web-development/index.html" rel="category tag">Web Development</a>				</div>
			
							<div class="tags-links">
					<div class="label">Tagged</div><a href="../../../tag/first-touch-tracking/index.html" rel="tag">first touch tracking</a>, <a href="../../../tag/google-analytics/index.html" rel="tag">google analytics</a>, <a href="../../../tag/magento-visit-tracking/index.html" rel="tag">magento visit tracking</a>				</div>
			
		
							<div class="comments-link">
					<div class="label">Comments</div>					<span class="comments-link"><a href="index.html#comments">14 Comments</a></span>
				</div>
					</aside>
				<div class="entry-content">
		<p>At the <a href="http://www.meetup.com/Auckland-Magento-User-Group/calendar/14094416/">recent</a> Auckland Magento Meetup I had the privilege of seeing <a href="http://twitter.com/hammersley">Mark Hammersley&#8217;s</a> presentation on email marketing &#8211; Mark&#8217;s a fascinating guy and a real expert, I highly recommend <a href="http://www.browsertobuyer.com/">checking out his site</a>. One of the things that came up during his presentation was the idea of first touch tracking your visits, particularly in the sense that if they first come to you because of an email, and you build a relationship with them and they eventually buy from you &#8211; knowing if it was an email and which one brought them to the store in the first place is very valuable information.</p>
<p>Magento does not track this out of the box and neither does Google Analytics, however with a simple customization it can be added to the store. This blog post will run through how I added it to two of our new World Wide Access stores, &lt;plug&gt; <a href="http://www.cariboocribs.co.uk/">Cariboo Cribs</a> &#8211; which sells cribs and cots to the UK and soon to the USA &#8211; and <a href="http://www.dominionnewzealand.com/">Dominion New Zealand</a> &#8211; which sells high quality sheepskin coats and boots (think New Zealand made Ugg).&lt;/plug&gt;</p>
<p><span id="more-957"></span></p>
<p>There are basically 3 steps to implementing this Magento customization &#8211; none of them are particularly tricky, Let&#8217;s do them together now.</p>
<h3>The Custom Javascript</h3>
<p>This functionality requires some custom javascript be added to your pages. The original code was created and is maintained by <a href="http://www.distilled.co.uk/">Distilled</a>. You can get the <a href="http://code.google.com/p/attributiontrackingga/">original version here</a> and <a href="http://www.distilled.co.uk/blog/seo/first-touch-tracking-in-google-analytics/">read the blog post about setting it up</a>. None of this would be possible without their original work, so big thanks to them.</p>
<p>To use this functionality in Magento (at least Magento 1.4.X) we need to add support for the <em>sort of</em> new <a href="http://code.google.com/apis/analytics/docs/gaJS/gaJSApi_gaq.html">async Google Analytics</a> code. To do this I added an extra function shown below to the bottom of the javascript file:</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #006600; font-style: italic;">// Updated to work with the Google analytics Async code by Ashley (aschroder.com)</span>
<span style="color: #006600; font-style: italic;">// refer to distilledFirstTouch() for comments.</span>
<span style="color: #000066; font-weight: bold;">function</span> asyncDistilledFirstTouch<span style="color: #009900;">&#40;</span>asyncStack<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
	<span style="color: #000066; font-weight: bold;">try</span> <span style="color: #009900;">&#123;</span>
		<span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>distilledCheckAnalyticsCookie<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">===</span> <span style="color: #CC0000;">0</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
			asyncStack.<span style="color: #660066;">push</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #3366CC;">'_setCustomVar'</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;l&quot;</span><span style="color: #339933;">,</span> distilledTruncate<span style="color: #009900;">&#40;</span>window.<span style="color: #660066;">location</span>.<span style="color: #660066;">pathname</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			asyncStack.<span style="color: #660066;">push</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #3366CC;">'_setCustomVar'</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">2</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;s&quot;</span><span style="color: #339933;">,</span> distilledTruncate<span style="color: #009900;">&#40;</span>window.<span style="color: #660066;">location</span>.<span style="color: #660066;">search</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			asyncStack.<span style="color: #660066;">push</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #3366CC;">'_setCustomVar'</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">3</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;r&quot;</span><span style="color: #339933;">,</span> distilledTruncate<span style="color: #009900;">&#40;</span>document.<span style="color: #660066;">referrer</span>.<span style="color: #660066;">substr</span><span style="color: #009900;">&#40;</span><span style="color: #CC0000;">7</span><span style="color: #339933;">,</span>document.<span style="color: #660066;">referrer</span>.<span style="color: #660066;">length</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
			asyncStack.<span style="color: #660066;">push</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #3366CC;">'_setCustomVar'</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">4</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">&quot;q&quot;</span><span style="color: #339933;">,</span> distilledTruncate<span style="color: #009900;">&#40;</span>document.<span style="color: #660066;">referrer</span>.<span style="color: #660066;">match</span><span style="color: #009900;">&#40;</span><span style="color: #009966; font-style: italic;">/(?:([#]|[?]|[&amp;]))(?:(encquery|k|p|q|qs|qt|query|rdata|search_word|szukaj|terms|text|wd|words))=[^&amp;]*/i</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #CC0000;">0</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #CC0000;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		<span style="color: #009900;">&#125;</span> 
	<span style="color: #009900;">&#125;</span> <span style="color: #000066; font-weight: bold;">catch</span> <span style="color: #009900;">&#40;</span>err<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><span style="color: #009900;">&#125;</span>
<span style="color: #009900;">&#125;</span></pre></td></tr></table><p class="theCode" style="display:none;">// Updated to work with the Google analytics Async code by Ashley (aschroder.com)
// refer to distilledFirstTouch() for comments.
function asyncDistilledFirstTouch(asyncStack){
	try {
		if (distilledCheckAnalyticsCookie() === 0){
			asyncStack.push(['_setCustomVar', 1, &quot;l&quot;, distilledTruncate(window.location.pathname), 1]);
			asyncStack.push(['_setCustomVar', 2, &quot;s&quot;, distilledTruncate(window.location.search), 1]);
			asyncStack.push(['_setCustomVar', 3, &quot;r&quot;, distilledTruncate(document.referrer.substr(7,document.referrer.length)), 1]);
			asyncStack.push(['_setCustomVar', 4, &quot;q&quot;, distilledTruncate(document.referrer.match(/(?:([#]|[?]|[&amp;]))(?:(encquery|k|p|q|qs|qt|query|rdata|search_word|szukaj|terms|text|wd|words))=[^&amp;]*/i)[0]), 1]);
		} 
	} catch (err) {}
}</p></div>

<p>The change is just to pass the async stack in to the function and use the <code>push</code> method to add the required <code>_setCustomVar</code> calls which then <a href="http://code.google.com/apis/analytics/docs/tracking/gaTrackingCustomVariables.html">show in Analytics as Custom Variables</a>.<del datetime="2010-08-11T22:33:00+00:00"> If you want my modified version, until the change (or a better one!) is applied to the project itself, you can <a href="../../../../cdn.aschroder.com/wp-content/uploads/2010/07/distilled.FirstTouch.js">download the whole custom javascript file</a>.</del><strong>Update:</strong> Will has published the changes in the Google Code project, you can <a href="https://attributiontrackingga.googlecode.com/svn/trunk/distilled.FirstTouch.js">get them from there directly</a> now. Thanks Will!</p>
<p>So now you should have the javascript file, let&#8217;s put it in to our Magento store and ensure it get&#8217;s included in the page HTML.</p>
<h3>Add the Javascript to Magento</h3>
<p>To add a piece of javascript to Magento pages we need to edit the <code>page.xml</code> file in your particular theme. So edit this file: <code>app/design/frontend/YOUR_PACKAGE/YOUR_THEME/layout/page.xml</code>, and add the following line of XML:</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="xml" style="font-family:monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;action</span> <span style="color: #000066;">method</span>=<span style="color: #ff0000;">&quot;addItem&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span><span style="color: #000000; font-weight: bold;">&lt;type<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>skin_js<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/type<span style="color: #000000; font-weight: bold;">&gt;</span></span><span style="color: #000000; font-weight: bold;">&lt;name<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>js/ga/distilled.FirstTouch.js<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/name<span style="color: #000000; font-weight: bold;">&gt;</span></span><span style="color: #000000; font-weight: bold;">&lt;/action<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table><p class="theCode" style="display:none;">&lt;action method=&quot;addItem&quot;&gt;&lt;type&gt;skin_js&lt;/type&gt;&lt;name&gt;js/ga/distilled.FirstTouch.js&lt;/name&gt;&lt;/action&gt;</p></div>

<p>Add the XMl to the end of the <code>&lt;block type="page/html_head" name="head" as="head"&gt;</code> section.</p>
<p>What that XML does is tells Magento when it is determining the layout for all pages to add the javascript <code>js/ga/distilled.FirstTouch.js</code> to your html head element. Great, now we need to actually add that javascript to the right place.</p>
<p>Copy the javascript code from the previous section to this directory (you will probably need to make the <code>ga</code> parent directory): <code>skin/frontend/YOUR_PACKAGE/YOUR_THEME/js/ga/</code></p>
<p>If you use the command line (and you should), something like this will work from the root of your Magento store:</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">wget</span> http:<span style="color: #000000; font-weight: bold;">//</span>www.aschroder.com<span style="color: #000000; font-weight: bold;">/</span>wp-content<span style="color: #000000; font-weight: bold;">/</span>uploads<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">2010</span><span style="color: #000000; font-weight: bold;">/</span>07<span style="color: #000000; font-weight: bold;">/</span>distilled.FirstTouch.js 
<span style="color: #c20cb9; font-weight: bold;">mkdir</span> skin<span style="color: #000000; font-weight: bold;">/</span>frontend<span style="color: #000000; font-weight: bold;">/</span>YOUR_PACKAGE<span style="color: #000000; font-weight: bold;">/</span>YOUR_THEME<span style="color: #000000; font-weight: bold;">/</span>js<span style="color: #000000; font-weight: bold;">/</span>ga<span style="color: #000000; font-weight: bold;">/</span>
<span style="color: #c20cb9; font-weight: bold;">mv</span> distilled.FirstTouch.js skin<span style="color: #000000; font-weight: bold;">/</span>frontend<span style="color: #000000; font-weight: bold;">/</span>YOUR_PACKAGE<span style="color: #000000; font-weight: bold;">/</span>YOUR_THEME<span style="color: #000000; font-weight: bold;">/</span>js<span style="color: #000000; font-weight: bold;">/</span>ga<span style="color: #000000; font-weight: bold;">/</span></pre></td></tr></table><p class="theCode" style="display:none;">wget http://www.aschroder.com/wp-content/uploads/2010/07/distilled.FirstTouch.js 
mkdir skin/frontend/YOUR_PACKAGE/YOUR_THEME/js/ga/
mv distilled.FirstTouch.js skin/frontend/YOUR_PACKAGE/YOUR_THEME/js/ga/</p></div>

<h3>Modify the Core Analytics code</h3>
<p>The last step is to make sure that our new custom code gets used by Magento when it renders the Google Analytics code. Don&#8217;t ask me why when they have a great templating engine at their disposal varien decided to put this code into a core Block file, but never-the-less we&#8217;ll need to override it in order to do what we want. Here&#8217;s the commands to do it on the command line:</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># First, if the file already exists, be careful modifying it and don't overwrite it below!</span>
<span style="color: #c20cb9; font-weight: bold;">ls</span> app<span style="color: #000000; font-weight: bold;">/</span>code<span style="color: #000000; font-weight: bold;">/</span>local<span style="color: #000000; font-weight: bold;">/</span>Mage<span style="color: #000000; font-weight: bold;">/</span>GoogleAnalytics<span style="color: #000000; font-weight: bold;">/</span>Block<span style="color: #000000; font-weight: bold;">/</span>Ga.php 
<span style="color: #c20cb9; font-weight: bold;">mkdir</span> <span style="color: #660033;">-p</span> app<span style="color: #000000; font-weight: bold;">/</span>code<span style="color: #000000; font-weight: bold;">/</span>local<span style="color: #000000; font-weight: bold;">/</span>Mage<span style="color: #000000; font-weight: bold;">/</span>GoogleAnalytics<span style="color: #000000; font-weight: bold;">/</span>Block<span style="color: #000000; font-weight: bold;">/</span>
<span style="color: #c20cb9; font-weight: bold;">cp</span> app<span style="color: #000000; font-weight: bold;">/</span>code<span style="color: #000000; font-weight: bold;">/</span>core<span style="color: #000000; font-weight: bold;">/</span>Mage<span style="color: #000000; font-weight: bold;">/</span>GoogleAnalytics<span style="color: #000000; font-weight: bold;">/</span>Block<span style="color: #000000; font-weight: bold;">/</span>Ga.php app<span style="color: #000000; font-weight: bold;">/</span>code<span style="color: #000000; font-weight: bold;">/</span>local<span style="color: #000000; font-weight: bold;">/</span>Mage<span style="color: #000000; font-weight: bold;">/</span>GoogleAnalytics<span style="color: #000000; font-weight: bold;">/</span>Block<span style="color: #000000; font-weight: bold;">/</span>
<span style="color: #c20cb9; font-weight: bold;">vi</span> app<span style="color: #000000; font-weight: bold;">/</span>code<span style="color: #000000; font-weight: bold;">/</span>local<span style="color: #000000; font-weight: bold;">/</span>Mage<span style="color: #000000; font-weight: bold;">/</span>GoogleAnalytics<span style="color: #000000; font-weight: bold;">/</span>Block<span style="color: #000000; font-weight: bold;">/</span>Ga.php <span style="color: #666666; font-style: italic;"># or use the editor of your choice</span></pre></td></tr></table><p class="theCode" style="display:none;"># First, if the file already exists, be careful modifying it and don't overwrite it below!
ls app/code/local/Mage/GoogleAnalytics/Block/Ga.php 
mkdir -p app/code/local/Mage/GoogleAnalytics/Block/
cp app/code/core/Mage/GoogleAnalytics/Block/Ga.php app/code/local/Mage/GoogleAnalytics/Block/
vi app/code/local/Mage/GoogleAnalytics/Block/Ga.php # or use the editor of your choice</p></div>

<p><strong>Note:</strong> Be careful not to override this if it already exists, for example <a href="http://www.magentocommerce.com/boards/viewthread/23325/P15/">I already had this fix</a> in mine.</p>
<p>Edit the file <code>app/code/local/Mage/GoogleAnalytics/Block/Ga.php</code> and add this line at around line 182:</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="javascript" style="font-family:monospace;">    asyncDistilledFirstTouch<span style="color: #009900;">&#40;</span>_gaq<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">    asyncDistilledFirstTouch(_gaq);</p></div>

<p>It should look like this:</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="php" style="font-family:monospace;">    _gaq<span style="color: #339933;">.</span>push<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">&quot;_setAccount&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;' . <span style="color: #006699; font-weight: bold;">$this-&gt;getAccount</span>() . '&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    asyncDistilledFirstTouch<span style="color: #009900;">&#40;</span>_gaq<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    _gaq<span style="color: #339933;">.</span>push<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#91;</span><span style="color: #0000ff;">&quot;_trackPageview&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;'.<span style="color: #006699; font-weight: bold;">$this-&gt;getPageName</span>().'&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table><p class="theCode" style="display:none;">    _gaq.push([&quot;_setAccount&quot;, &quot;' . $this-&gt;getAccount() . '&quot;]);
    asyncDistilledFirstTouch(_gaq);
    _gaq.push([&quot;_trackPageview&quot;, &quot;'.$this-&gt;getPageName().'&quot;]);</p></div>

<h3>Check it&#8217;s working</h3>
<p>Right, now you can clear your Magento cache and check your handywork worked. You&#8217;re doing this in a test environment, right? So if you made a mistake, it won&#8217;t be a big problem for your visitors. To check it&#8217;s working look for  2 things in the source code of your Magento page (view source).</p>
<p>1) The  <strong> asyncDistilledFirstTouch(_gaq);</strong> we added should now show up.</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="html" style="font-family:monospace;">&lt;!-- BEGIN GOOGLE ANALYTICS CODE --&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
//&lt;![CDATA[
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
    })();
    // Fix from: http://www.magentocommerce.com/boards/viewthread/23325/P15/
	var _gaq = _gaq || [];
    _gaq.push([&quot;_setAccount&quot;, &quot;UA-4134648-12&quot;]);
    asyncDistilledFirstTouch(_gaq);
    _gaq.push([&quot;_trackPageview&quot;, &quot;/magento/dominion/&quot;]);
//]]&gt;
&lt;/script&gt;
&lt;!-- END GOOGLE ANALYTICS CODE --&gt;</pre></td></tr></table><p class="theCode" style="display:none;">&lt;!-- BEGIN GOOGLE ANALYTICS CODE --&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
//&lt;![CDATA[
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
    })();
    // Fix from: http://www.magentocommerce.com/boards/viewthread/23325/P15/
	var _gaq = _gaq || [];
    _gaq.push([&quot;_setAccount&quot;, &quot;UA-4134648-12&quot;]);
    asyncDistilledFirstTouch(_gaq);
    _gaq.push([&quot;_trackPageview&quot;, &quot;/magento/dominion/&quot;]);
//]]&gt;
&lt;/script&gt;
&lt;!-- END GOOGLE ANALYTICS CODE --&gt;</p></div>

<p>2) The javascript should be imported:</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="html" style="font-family:monospace;">&lt;script type=&quot;text/javascript&quot; src=&quot;http://yourdomain.com/skin/frontend/dominion/dominion/js/ga/distilled.FirstTouch.js&quot;&gt;&lt;/script&gt;</pre></td></tr></table><p class="theCode" style="display:none;">&lt;script type=&quot;text/javascript&quot; src=&quot;http://yourdomain.com/skin/frontend/dominion/dominion/js/ga/distilled.FirstTouch.js&quot;&gt;&lt;/script&gt;</p></div>

<p><strong>Note:</strong> Your <a href="https://developer.mozilla.org/en/Debugging_JavaScript">javascript console</a> shouldn&#8217;t show any errors either &#8211; clear it and refresh the page to check.</p>
<h3>Now what?</h3>
<p>Give it a day or so and you should see your results coming through Google Analytics in the <code>Visitors -> Custom Variables</code> section. I am absolutely not an expert at Google Analytics reporting so I&#8217;m not sure the best way to actually report this data, if we&#8217;re really lucky someone might post a comment with some tips on that. All I did was make a custom report that shows source as the first level and then various custom variable values as second layers. This let&#8217;s you see the original source for other sources (and you could look at conversion rate of those visits too).</p>
<p>Also, if there is enough interest in this functionality, I&#8217;ll consider making it a free Magento extension too as even though the changes are simple, there&#8217;s a lot of fiddling around which might be easier if it can be avoided with an extension. So if you like the idea of doing this got put off by the thought of modifying PHP and XML files, then let me know.</p>
<p>Oh and as always, any feedback greatly appreciated!</p>
<div class='yarpp-related'>
<p>You might also be interested in:<ol>
<li><a href="../../../2009/04/how-to-bulk-enable-products-when-google-checkout-is-disabled-in-magento/index.html" rel="bookmark" title="How to Bulk Enable Products when Google Checkout is Disabled in Magento">How to Bulk Enable Products when Google Checkout is Disabled in Magento </a></li>
<li><a href="../../../2008/12/magento-117-google-checkout-and-free-shipping-part-2/index.html" rel="bookmark" title="Magento 1.1.7 Google Checkout and Free Shipping (part 2)">Magento 1.1.7 Google Checkout and Free Shipping (part 2) </a></li>
<li><a href="../../../2009/07/removing-the-compare-function-in-magento-the-easy-way/index.html" rel="bookmark" title="Removing the Compare function in Magento, the easy way">Removing the Compare function in Magento, the easy way </a></li>
<li><a href="../../09/shipwire-tracking-api-mapping-api-carrier-codes-in-tracking-updates-within-magento/index.html" rel="bookmark" title="Shipwire Tracking API &#8211; Mapping API carrier codes in Tracking updates within Magento">Shipwire Tracking API &#8211; Mapping API carrier codes in Tracking updates within Magento </a></li>
<li><a href="../../../2009/12/a-super-simple-magento-store-monitoring-tool-powered-by-google-app-engine/index.html" rel="bookmark" title="A super simple Magento store monitoring tool powered by Google App Engine">A super simple Magento store monitoring tool powered by Google App Engine </a></li>
</ol></p>
</div>
		</div><!-- .entry-content -->
		<nav id="post-navigation" class="navigation post-navigation" role="navigation" aria-label="Post Navigation"><span class="screen-reader-text">Post navigation</span><div class="nav-links"><div class="nav-previous"><a href="../../07/latest-version-of-smtp-pro-finally-uploaded-to-magento-connect/index.html" rel="prev">Latest version of SMTP Pro Finally Uploaded to Magento Connect</a></div><div class="nav-next"><a href="../improved-custom-magento-order-number-functionality-for-setstartordernumber-extension-v0-3/index.html" rel="next">Improved Custom Magento Order Number Functionality for SetStartOrderNumber extension &#8211; v0.3</a></div></div></nav>
<section id="comments" class="comments-area" aria-label="Post Comments">

			<h2 class="comments-title">
			14 thoughts on &ldquo;<span>Magento and Google Analytics &#8211; Use &#8216;First Touch&#8217; Tracking To See How Your Customers First Visit Your Store</span>&rdquo;		</h2>

		
		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1676">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/76c95c8e802bdd03ff3532d7ea696dcd?s=128&amp;d=mm&amp;r=g' srcset="http://1.gravatar.com/avatar/76c95c8e802bdd03ff3532d7ea696dcd?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn">J.T.</cite>			</div>
			
			<a href="index.html#comment-1676" class="comment-date">
				<time datetime="2010-08-05T01:04:22+00:00">August 5, 2010</time>			</a>
		</div>
				<div id="div-comment-1676" class="comment-content">
				<div class="comment-text">
		<p>Interesting, as always!</p>
<p>When we send emails, we use this instead, no Mage hacking required:</p>
<p><a href="http://www.google.com/support/analytics/bin/answer.py?hl=en&amp;answer=55578" rel="nofollow">http://www.google.com/support/analytics/bin/answer.py?hl=en&#038;answer=55578</a></p>
<p>Then stick that URL in bit.ly so they&#8217;re nice and short and give you a real-time tracking mechanism, satisfying that need-to-know-now desire. A day later, Google Analytics will show everything broken down not just by email campaign, or actual email, but depending how you use above tool, even by the actual link they clicked first.</p>
<p>Lastly, if it&#8217;s a big mail-out, it&#8217;s very exciting to then launch Woopra (www.woopra.com) and watch the traffic in real-time clicking through your site, putting stuff in the basket and checking out.</p>
<p>As we often say in Europe, or Holland at least, many/all roads lead to Rome. There isn&#8217;t necessarily a right or wrong way to get there, but some are smoother, or more fancy, or quicker. </p>
<p>Always nice to see how others get there! </p>
<p>Last week we had a Mage Meet-up in London and there were people preparing for Magento shops taking a thousand orders a day. That&#8217;s certainly cool stuff to hear about.</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1677">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn">Ashley</cite>			</div>
			
			<a href="index.html#comment-1677" class="comment-date">
				<time datetime="2010-08-05T02:04:05+00:00">August 5, 2010</time>			</a>
		</div>
				<div id="div-comment-1677" class="comment-content">
				<div class="comment-text">
		<p>Hi, Thanks JT &#8211; I think that&#8217;s good for the specific email tracking right? Services like Mailchimp even take care of it for you (Mailchimp is great btw, they get my seal of approval!). </p>
<p>What that means is the campaign info is already added to the URL&#8217;s in the email for you.</p>
<p>What this functionality adds is that if the first visit to your site was from an email, then forever (till the cookie goes away) after you would have recorded that info. So if they later search your site name directly in google to come back to you on the 5th visit and buy, you&#8217;ll be able to look back and see that the _first_ time they came to you it was from your email, and you can give your email marketers a pat on the back and a banana break!</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1678">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/76c95c8e802bdd03ff3532d7ea696dcd?s=128&amp;d=mm&amp;r=g' srcset="http://1.gravatar.com/avatar/76c95c8e802bdd03ff3532d7ea696dcd?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn">J.T.</cite>			</div>
			
			<a href="index.html#comment-1678" class="comment-date">
				<time datetime="2010-08-05T02:23:52+00:00">August 5, 2010</time>			</a>
		</div>
				<div id="div-comment-1678" class="comment-content">
				<div class="comment-text">
		<p>Yes, I think you are right there in that as standard, my way wouldn&#8217;t be persistent. My GF works at one of the larger PPC companies and they use Searchware, Marin etc. to track clicks and they too do what you describe, recording where the very first touchdown originated from. </p>
<p>To have that in Magento like you describe (for free) is very neat indeed. </p>
<p>I&#8217;ll make sure I&#8217;m fully awake before I comment next time ðŸ™‚</p>
<p>Re Mailchimp, for data related laws and regulations, I&#8217;m still waiting for a pure UK based service which is fully integrated with Magento. Until that day, we&#8217;ll use in-house tools like SogarCRM or Magento itself even. Setting up your own server MTA for maximum deliverability is a Royal PITA but once you know the 600 steps involved, it works quite nicely. The things us geeks have to suffer&#8230;</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1699">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0551158e4fe4424709ff1c40843687fa?s=128&amp;d=mm&amp;r=g' srcset="http://0.gravatar.com/avatar/0551158e4fe4424709ff1c40843687fa?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn"><a href='http://www.merchantguru.com/' rel='external nofollow' class='url'>Joe Fletcher</a></cite>			</div>
			
			<a href="index.html#comment-1699" class="comment-date">
				<time datetime="2010-08-09T17:53:35+00:00">August 9, 2010</time>			</a>
		</div>
				<div id="div-comment-1699" class="comment-content">
				<div class="comment-text">
		<p>I&#8217;ll register my vote of interest in this as an extension. I&#8217;m sure you can write it up on your train ride home like your others. ðŸ˜‰ But seriously, this would be great to have. If it doesn&#8217;t make its way into an extension, the steps above look pretty straightforward and I&#8217;m sure I&#8217;ll end up adding this into my sites down the road.</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="comment-1700">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn">Ashley</cite>			</div>
			
			<a href="index.html#comment-1700" class="comment-date">
				<time datetime="2010-08-09T18:18:10+00:00">August 9, 2010</time>			</a>
		</div>
				<div id="div-comment-1700" class="comment-content">
				<div class="comment-text">
		<p>vote registered! You may not have to wait for me though, I heard from Fooman that he might add this to his GA extension, so that&#8217;d be good eh.  I&#8217;ll let you know if I hear any more.</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1718">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/8c6a0945cf76d1291dc714a4fc1a85b8?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/8c6a0945cf76d1291dc714a4fc1a85b8?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn"><a href='http://www.marine-deals.co.nz/' rel='external nofollow' class='url'>Graham</a></cite>			</div>
			
			<a href="index.html#comment-1718" class="comment-date">
				<time datetime="2010-08-12T17:05:16+00:00">August 12, 2010</time>			</a>
		</div>
				<div id="div-comment-1718" class="comment-content">
				<div class="comment-text">
		<p>Hey Ash,</p>
<p>Just trying this, can&#8217;t seem to get it to work&#8230;ie results not coming through to Visitors -&gt; Custom Variables.</p>
<p>I&#8217;ve given it more than a day since I made the changes. In view source I can see the js loading (in the Fooman mimify stuff) and, the correct line in the analytics code (modified the Fooman Ga.php).</p>
<p>Anything else I should check?</p>
<p>Cheers</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="comment-1719">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn">Ashley</cite>			</div>
			
			<a href="index.html#comment-1719" class="comment-date">
				<time datetime="2010-08-12T17:27:39+00:00">August 12, 2010</time>			</a>
		</div>
				<div id="div-comment-1719" class="comment-content">
				<div class="comment-text">
		<p>Hi, Graham &#8211; I just had a quick look at your source code &#8211; I think you&#8217;re using the older, non-async GA code. In that case, refer to the original article about how to add the distilled javascript call to your GA.php. Let me know how that goes.</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1727">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0443d9e25d8e1f01b89b340d78d3073f?s=128&amp;d=mm&amp;r=g' srcset="http://0.gravatar.com/avatar/0443d9e25d8e1f01b89b340d78d3073f?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn"><a href='http://www.botechnology.com/' rel='external nofollow' class='url'>loopion</a></cite>			</div>
			
			<a href="index.html#comment-1727" class="comment-date">
				<time datetime="2010-08-13T12:53:01+00:00">August 13, 2010</time>			</a>
		</div>
				<div id="div-comment-1727" class="comment-content">
				<div class="comment-text">
		<p>I&#8217;ll be very interested to see this extension too. Even if it&#8217;s integrated to Fooman extension, it will be great.</p>
<p>We are using MailChimp too for one of our clients and it&#8217;s linked with their Google Analytics account, but it&#8217;s more like a complement as like you said Ashley, it&#8217;s also for a global report for individual report.</p>
<p>Keep us posted about the extension!</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1923">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5513e4f31a2cd7ad5d1081a9481ff71e?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/5513e4f31a2cd7ad5d1081a9481ff71e?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn"><a href='http://www.blisshq.com/' rel='external nofollow' class='url'>Dan Gravell</a></cite>			</div>
			
			<a href="index.html#comment-1923" class="comment-date">
				<time datetime="2010-10-19T00:53:29+00:00">October 19, 2010</time>			</a>
		</div>
				<div id="div-comment-1923" class="comment-content">
				<div class="comment-text">
		<p>I don&#8217;t get anything in the User Defined or Custom Variables reports at all (or rather: I get &#8220;(not set)&#8221; for every visitor in the User Defined report, and &#8220;You have 0 unique custom variables&#8221; in the custom variables report). Here&#8217;s my code (I should be clear: I&#8217;m not using Magento): </p>
<pre>
&lt;script type=&quot;text/javascript&quot; src=&quot;http://attributiontrackingga.googlecode.com/svn/trunk/distilled.FirstTouch.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot;&gt;    var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-XXXXXXX-1']);  _gaq.push(['_setDomainName', 'none']);  _gaq.push(['_setAllowLinker', true]);  asyncDistilledFirstTouch(_gaq);  _gaq.push(['_trackPageview']);   (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })(); &lt;/script&gt; 
</pre>
<p>Is this correct usage? There are no JS errors and I can debug it line by line in Firebug.</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1937">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5513e4f31a2cd7ad5d1081a9481ff71e?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/5513e4f31a2cd7ad5d1081a9481ff71e?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn"><a href='http://www.blisshq.com/' rel='external nofollow' class='url'>Dan Gravell</a></cite>			</div>
			
			<a href="index.html#comment-1937" class="comment-date">
				<time datetime="2010-10-23T04:47:09+00:00">October 23, 2010</time>			</a>
		</div>
				<div id="div-comment-1937" class="comment-content">
				<div class="comment-text">
		<p>Just to let you know &#8211; the results have just started coming through. It took five days in total to appear and you can&#8217;t see yesterday&#8217;s results&#8230; but prior to that they exist.</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="comment-1938">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn">Ashley</cite>			</div>
			
			<a href="index.html#comment-1938" class="comment-date">
				<time datetime="2010-10-23T08:47:29+00:00">October 23, 2010</time>			</a>
		</div>
				<div id="div-comment-1938" class="comment-content">
				<div class="comment-text">
		<p>Thanks for stopping back in Dan &#8211; I think my data took about a day to start coming through, so hopefully you&#8217;re just experiencing some intermittent slowness with the analytics data.</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2338">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/866b275831874b9e75aec899c995c4af?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/866b275831874b9e75aec899c995c4af?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn"><a href='http://www.so-what.biz/' rel='external nofollow' class='url'>So What</a></cite>			</div>
			
			<a href="index.html#comment-2338" class="comment-date">
				<time datetime="2011-06-02T10:01:28+00:00">June 2, 2011</time>			</a>
		</div>
				<div id="div-comment-2338" class="comment-content">
				<div class="comment-text">
		<p>This &#8220;first touch&#8221; tracking is a great idea !<br />
I just installed the Fooman extension. Should I do some other operation manually (maybe add the code in page.xml&#8230;) or everything is now in the Fooman extensio ?<br />
Thanks</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-2412">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/fefbffdaa3049ebba4e94e5260257900?s=128&amp;d=mm&amp;r=g' srcset="http://0.gravatar.com/avatar/fefbffdaa3049ebba4e94e5260257900?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn">eg1902</cite>			</div>
			
			<a href="index.html#comment-2412" class="comment-date">
				<time datetime="2011-06-29T01:08:08+00:00">June 29, 2011</time>			</a>
		</div>
				<div id="div-comment-2412" class="comment-content">
				<div class="comment-text">
		<p>I&#8217;m in the same case as So What. Have I to do something manually after the install of Fooman extension ?<br />
Thanks</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5127">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/dd712bf4172bb08f77a6b731225da6e6?s=128&amp;d=mm&amp;r=g' srcset="http://1.gravatar.com/avatar/dd712bf4172bb08f77a6b731225da6e6?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn">Jeroen</cite>			</div>
			
			<a href="index.html#comment-5127" class="comment-date">
				<time datetime="2012-11-08T08:31:57+00:00">November 8, 2012</time>			</a>
		</div>
				<div id="div-comment-5127" class="comment-content">
				<div class="comment-text">
		<p>Hello all.</p>
<p>I have a spinning head&#8230;.i can not solve a problem.</p>
<p>We have put UA-code in Magento and it is seeable on frontend.<br />
BUT&#8230;.at some pc&#8217;s it is not shown in source????<br />
Why??? People are on SAME IP. I do not know why Magento somethimes shows UA-code and sometimes not. We have problems with our reporst in Analytics now&#8230;</p>
<p>Please help me out&#8230;.Thanks!<br />
Jeroen</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

				<p class="no-comments">Comments are closed.</p>
	
</section><!-- #comments -->

</div><!-- #post-## -->

		</main><!-- #main -->
	</div><!-- #primary -->


		</div><!-- .col-full -->
	</div><!-- #content -->

	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="col-full">

					<div class="site-info">
			&copy; ASchroder.com 2023						<br /> Storefront designed by <a href="http://www.woocommerce.com/" title="WooCommerce - The Best eCommerce Platform for WordPress" rel="author">WooCommerce</a>.					</div><!-- .site-info -->
		
		</div><!-- .col-full -->
	</footer><!-- #colophon -->

	
</div><!-- #page -->

<link rel='stylesheet' id='yarppRelatedCss-css'  href='../../../wp-content/plugins/yet-another-related-posts-plugin/style/related101e.css?ver=4.8.15' type='text/css' media='all' />
<script type='text/javascript' src='../../../wp-content/plugins/wp-syntax/js/wp-syntax4963.js?ver=1.1'></script>
<script type='text/javascript' src='../../../../cdn.aschroder.com/wp-content/themes/storefront/assets/js/navigation.min11a8.js?ver=20120206'></script>
<script type='text/javascript' src='../../../../cdn.aschroder.com/wp-content/themes/storefront/assets/js/skip-link-focus-fix.min08e0.js?ver=20130115'></script>
<script type='text/javascript' src='../../../../cdn.aschroder.com/wp-includes/js/wp-embed.min101e.js?ver=4.8.15'></script>

</body>

<!-- Mirrored from www.aschroder.com/2010/08/magento-and-google-analytics-use-first-touch-tracking-to-see-how-your-customers-first-visit-your-store/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 30 Aug 2023 22:34:50 GMT -->
</html>

<!-- Performance optimized by W3 Total Cache. Learn more: https://www.w3-edge.com/products/

Page Caching using disk
Content Delivery Network via cdn.aschroder.com

 Served from: www.aschroder.com @ 2023-08-30 14:23:41 by W3 Total Cache -->