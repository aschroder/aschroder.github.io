<!doctype html>
<html lang="en-US">

<!-- Mirrored from www.aschroder.com/2013/04/actually-running-magento-on-amazons-elastic-beanstalk-cloud-platform/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 30 Aug 2023 22:28:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="../../../xmlrpc.php">

<title>Actually running Magento on Amazon&#039;s Elastic Beanstalk Cloud platform | ASchroder.com</title>

<!-- All in One SEO Pack 2.4.2 by Michael Torbert of Semper Fi Web Design[289,393] -->
<meta name="description"  content="In this post I will run through the actual setup of a very basic Magento install &#039;in the cloud&#039; and the process of deploying changes" />

<!-- /all in one seo pack -->
<link rel='dns-prefetch' href='http://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="ASchroder.com &raquo; Feed" href="../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="ASchroder.com &raquo; Comments Feed" href="../../../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="ASchroder.com &raquo; Actually running Magento on Amazon&#8217;s Elastic Beanstalk Cloud platform Comments Feed" href="feed/index.html" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v6.2.4 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
		var disableStr = 'ga-disable-UA-6477134-1';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','http://www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-6477134-1', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('send','pageview');
</script>
<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.aschroder.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.15"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='yarppWidgetCss-css'  href='../../../wp-content/plugins/yet-another-related-posts-plugin/style/widget101e.css?ver=4.8.15' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='../../../wp-content/plugins/wp-syntax/css/wp-syntax4963.css?ver=1.1' type='text/css' media='all' />
<link rel='stylesheet' id='storefront-style-css'  href='../../../../cdn.aschroder.com/wp-content/themes/storefront/style5bf8.css?ver=2.2.5' type='text/css' media='all' />
<style id='storefront-style-inline-css' type='text/css'>

			.main-navigation ul li a,
			.site-title a,
			ul.menu li a,
			.site-branding h1 a,
			.site-footer .storefront-handheld-footer-bar a:not(.button),
			button.menu-toggle,
			button.menu-toggle:hover {
				color: #333333;
			}

			button.menu-toggle,
			button.menu-toggle:hover {
				border-color: #333333;
			}

			.main-navigation ul li a:hover,
			.main-navigation ul li:hover > a,
			.site-title a:hover,
			a.cart-contents:hover,
			.site-header-cart .widget_shopping_cart a:hover,
			.site-header-cart:hover > li > a,
			.site-header ul.menu li.current-menu-item > a {
				color: #838383;
			}

			table th {
				background-color: #f8f8f8;
			}

			table tbody td {
				background-color: #fdfdfd;
			}

			table tbody tr:nth-child(2n) td,
			fieldset,
			fieldset legend {
				background-color: #fbfbfb;
			}

			.site-header,
			.secondary-navigation ul ul,
			.main-navigation ul.menu > li.menu-item-has-children:after,
			.secondary-navigation ul.menu ul,
			.storefront-handheld-footer-bar,
			.storefront-handheld-footer-bar ul li > a,
			.storefront-handheld-footer-bar ul li.search .site-search,
			button.menu-toggle,
			button.menu-toggle:hover {
				background-color: #ffffff;
			}

			p.site-description,
			.site-header,
			.storefront-handheld-footer-bar {
				color: #6d6d6d;
			}

			.storefront-handheld-footer-bar ul li.cart .count,
			button.menu-toggle:after,
			button.menu-toggle:before,
			button.menu-toggle span:before {
				background-color: #333333;
			}

			.storefront-handheld-footer-bar ul li.cart .count {
				color: #ffffff;
			}

			.storefront-handheld-footer-bar ul li.cart .count {
				border-color: #ffffff;
			}

			h1, h2, h3, h4, h5, h6 {
				color: #333333;
			}

			.widget h1 {
				border-bottom-color: #333333;
			}

			body,
			.secondary-navigation a,
			.onsale,
			.pagination .page-numbers li .page-numbers:not(.current), .woocommerce-pagination .page-numbers li .page-numbers:not(.current) {
				color: #6d6d6d;
			}

			.widget-area .widget a,
			.hentry .entry-header .posted-on a,
			.hentry .entry-header .byline a {
				color: #9f9f9f;
			}

			a  {
				color: #0228d1;
			}

			a:focus,
			.button:focus,
			.button.alt:focus,
			.button.added_to_cart:focus,
			.button.wc-forward:focus,
			button:focus,
			input[type="button"]:focus,
			input[type="reset"]:focus,
			input[type="submit"]:focus {
				outline-color: #0228d1;
			}

			button, input[type="button"], input[type="reset"], input[type="submit"], .button, .added_to_cart, .widget a.button, .site-header-cart .widget_shopping_cart a.button {
				background-color: #eeeeee;
				border-color: #eeeeee;
				color: #333333;
			}

			button:hover, input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover, .button:hover, .added_to_cart:hover, .widget a.button:hover, .site-header-cart .widget_shopping_cart a.button:hover {
				background-color: #d5d5d5;
				border-color: #d5d5d5;
				color: #333333;
			}

			button.alt, input[type="button"].alt, input[type="reset"].alt, input[type="submit"].alt, .button.alt, .added_to_cart.alt, .widget-area .widget a.button.alt, .added_to_cart, .widget a.button.checkout {
				background-color: #333333;
				border-color: #333333;
				color: #ffffff;
			}

			button.alt:hover, input[type="button"].alt:hover, input[type="reset"].alt:hover, input[type="submit"].alt:hover, .button.alt:hover, .added_to_cart.alt:hover, .widget-area .widget a.button.alt:hover, .added_to_cart:hover, .widget a.button.checkout:hover {
				background-color: #1a1a1a;
				border-color: #1a1a1a;
				color: #ffffff;
			}

			.pagination .page-numbers li .page-numbers.current, .woocommerce-pagination .page-numbers li .page-numbers.current {
				background-color: #e6e6e6;
				color: #6d6d6d;
			}

			#comments .comment-list .comment-content .comment-text {
				background-color: #f8f8f8;
			}

			.site-footer {
				background-color: #f0f0f0;
				color: #6d6d6d;
			}

			.site-footer a:not(.button) {
				color: #333333;
			}

			.site-footer h1, .site-footer h2, .site-footer h3, .site-footer h4, .site-footer h5, .site-footer h6 {
				color: #333333;
			}

			#order_review {
				background-color: #ffffff;
			}

			#payment .payment_methods > li .payment_box,
			#payment .place-order {
				background-color: #fafafa;
			}

			#payment .payment_methods > li:not(.woocommerce-notice) {
				background-color: #f5f5f5;
			}

			#payment .payment_methods > li:not(.woocommerce-notice):hover {
				background-color: #f0f0f0;
			}

			@media screen and ( min-width: 768px ) {
				.secondary-navigation ul.menu a:hover {
					color: #868686;
				}

				.secondary-navigation ul.menu a {
					color: #6d6d6d;
				}

				.site-header-cart .widget_shopping_cart,
				.main-navigation ul.menu ul.sub-menu,
				.main-navigation ul.nav-menu ul.children {
					background-color: #f0f0f0;
				}

				.site-header-cart .widget_shopping_cart .buttons,
				.site-header-cart .widget_shopping_cart .total {
					background-color: #f5f5f5;
				}

				.site-header {
					border-bottom-color: #f0f0f0;
				}
			}
</style>
<link rel='stylesheet' id='storefront-icons-css'  href='../../../../cdn.aschroder.com/wp-content/themes/storefront/assets/sass/base/icons5bf8.css?ver=2.2.5' type='text/css' media='all' />
<link rel='stylesheet' id='storefront-fonts-css'  href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,300italic,400italic,600,700,900&amp;subset=latin%2Clatin-ext' type='text/css' media='all' />
<script type='text/javascript' src='../../../../cdn.aschroder.com/wp-includes/js/jquery/jqueryb8ff.js?ver=1.12.4'></script>
<script type='text/javascript' src='../../../../cdn.aschroder.com/wp-includes/js/jquery/jquery-migrate.min330a.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='../../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Magento and AWS Elastic Beanstalk &#8211; The Scalability Silver Bullet?' href='../magento-and-aws-elastic-beanstalk-the-scalability-silver-bullet/index.html' />
<link rel='next' title='Understanding and Detecting Magento Extension Clashes or Conflicts' href='../understanding-and-detecting-magento-extension-clashes-or-conflicts/index.html' />
<meta name="generator" content="WordPress 4.8.15" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='../../../index7c5e.html?p=1983' />
<link rel="alternate" type="application/json+oembed" href="../../../wp-json/oembed/1.0/embedfaba.json?url=http%3A%2F%2Fwww.aschroder.com%2F2013%2F04%2Factually-running-magento-on-amazons-elastic-beanstalk-cloud-platform%2F" />
<link rel="alternate" type="text/xml+oembed" href="../../../wp-json/oembed/1.0/embedbfe8?url=http%3A%2F%2Fwww.aschroder.com%2F2013%2F04%2Factually-running-magento-on-amazons-elastic-beanstalk-cloud-platform%2F&amp;format=xml" />
</head>

<body class="post-template-default single single-post postid-1983 single-format-standard no-wc-breadcrumb storefront-full-width-content right-sidebar">


<div id="page" class="hfeed site">
	
	<header id="masthead" class="site-header" role="banner" style="">
		<div class="col-full">

					<a class="skip-link screen-reader-text" href="#site-navigation">Skip to navigation</a>
		<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
				<div class="site-branding">
			<div class="beta site-title"><a href="../../../index.html" rel="home">ASchroder.com</a></div><p class="site-description">Notes on Web Development</p>		</div>
		<div class="storefront-primary-navigation">		<nav id="site-navigation" class="main-navigation" role="navigation" aria-label="Primary Navigation">
		<button class="menu-toggle" aria-controls="site-navigation" aria-expanded="false"><span>Menu</span></button>
			<div class="primary-navigation"><ul id="menu-main-menu" class="menu"><li id="menu-item-1119" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1119"><a href="../../../index.html">Home</a></li>
<li id="menu-item-1118" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1118"><a href="../../../about/index.html">About</a></li>
<li id="menu-item-1872" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1872"><a href="../../../presentations/index.html">Presentations</a></li>
</ul></div><div class="handheld-navigation"><ul id="menu-main-menu-1" class="menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1119"><a href="../../../index.html">Home</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1118"><a href="../../../about/index.html">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1872"><a href="../../../presentations/index.html">Presentations</a></li>
</ul></div>		</nav><!-- #site-navigation -->
		</div>
		</div>
	</header><!-- #masthead -->

	
	<div id="content" class="site-content" tabindex="-1">
		<div class="col-full">

		
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
<div id="post-1983" class="post-1983 post type-post status-publish format-standard hentry category-hosting category-php category-web-development tag-aws tag-cloud tag-ec2 tag-elastic-beanstalk tag-magento tag-php">

			<header class="entry-header">
		<span class="posted-on">Posted on <a href="index.html" rel="bookmark"><time class="entry-date published updated" datetime="2013-04-07T13:25:03+00:00">April 7, 2013</time></a></span><h1 class="entry-title">Actually running Magento on Amazon&#8217;s Elastic Beanstalk Cloud platform</h1>		</header><!-- .entry-header -->
				<aside class="entry-meta">
						<div class="author">
				<img alt='' src='http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/29dbad2c1a21916b69ff05e64c16b23b?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' /><div class="label">Written by</div><a href="../../../author/admin/index.html" title="Posts by Ashley" rel="author">Ashley</a>			</div>
							<div class="cat-links">
					<div class="label">Posted in</div><a href="../../../category/hosting/index.html" rel="category tag">Hosting</a>, <a href="../../../category/php/index.html" rel="category tag">PHP</a>, <a href="../../../category/web-development/index.html" rel="category tag">Web Development</a>				</div>
			
							<div class="tags-links">
					<div class="label">Tagged</div><a href="../../../tag/aws/index.html" rel="tag">aws</a>, <a href="../../../tag/cloud/index.html" rel="tag">cloud</a>, <a href="../../../tag/ec2/index.html" rel="tag">ec2</a>, <a href="../../../tag/elastic-beanstalk/index.html" rel="tag">elastic beanstalk</a>, <a href="../../../tag/magento/index.html" rel="tag">Magento</a>, <a href="../../../tag/php/index.html" rel="tag">PHP</a>				</div>
			
		
							<div class="comments-link">
					<div class="label">Comments</div>					<span class="comments-link"><a href="index.html#comments">2 Comments</a></span>
				</div>
					</aside>
				<div class="entry-content">
		<p>In my previous post I weighed up <a href="../magento-and-aws-elastic-beanstalk-the-scalability-silver-bullet/index.html">the benefits and limitations of Amazon&#8217;s Elastic Beanstalk hosting environment for Magento</a> and took a very vague look at the costs. In this post I will run through the actual setup of a very basic Magento install &#8216;<em>in the cloud</em>&#8216; and the process of deploying changes. The goal for this initial setup is to keep everything bone stock as possible, we want minimal maintenance effort and an automated environment.</p>
<p><del datetime="2013-04-07T11:04:39+00:00">If we have some time at the end, we&#8217;ll do some stress testing of the platform to see how it handles customers.</del> Benchmarks will have to wait, <em>stay tuned</em>.</p>
<h3>The Tools</h3>
<p>For this tutorial we&#8217;ll be working in a linux environment. I used a small EC2 server with the AWS default Linux AMI as the setup box, it&#8217;s nice and fast being on the same network as the Beanstalk platform. Make sure you have the following installed.</p>
<ul>
<li><a href="http://aws.amazon.com/code/6752709412171743">AWS EB tools</a>, and the <a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/usingCLI.html">getting started guide</a></li>
<li>git, <code>sudo yum install git</code></li>
<li>ruby, <code>sudo yum install ruby</code></li>
<li>python 2.7, <code>sudo yum install python27</code> &#8211; this one is a bit of a pain on the AWS default Linux AMI, you&#8217;ll need to hack in explicit use of the 2.7 binary in the AWS scripts. Or, <em>heaven forbid</em>, set it up properly and compile from source&#8230;</li>
</ul>
<p>Once you have those in place, you should be ready to get Magento and the Beanstalk environment setup.<br />
<span id="more-1983"></span></p>
<h3>Preparation of the Magento store</h3>
<p>Firstly download and extract the latest magento.</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">wget</span> http:<span style="color: #000000; font-weight: bold;">//</span>www.magentocommerce.com<span style="color: #000000; font-weight: bold;">/</span>downloads<span style="color: #000000; font-weight: bold;">/</span>assets<span style="color: #000000; font-weight: bold;">/</span>1.7.0.2<span style="color: #000000; font-weight: bold;">/</span>magento-1.7.0.2.tar.gz
<span style="color: #c20cb9; font-weight: bold;">tar</span> xzf magento-1.7.0.2.tar.gz
<span style="color: #7a0874; font-weight: bold;">cd</span> magento
<span style="color: #666666; font-style: italic;"># From the AWS EB tools</span>
AWSDevTools-RepositorySetup.sh</pre></td></tr></table><p class="theCode" style="display:none;">wget http://www.magentocommerce.com/downloads/assets/1.7.0.2/magento-1.7.0.2.tar.gz
tar xzf magento-1.7.0.2.tar.gz
cd magento
# From the AWS EB tools
AWSDevTools-RepositorySetup.sh</p></div>

<p>Now we create a simple <code>hello.php</code> PHP file in the root of the Magento store &#8211; it&#8217;ll serve as a basic heartbeat test in the Beanstalk environment, it could be extended to check other health measures for Magento but for now it&#8217;s just to ensure the regular heartbeats don&#8217;t interfere with the install.</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># Just put a helloworld in the file like this &lt;?php echo &quot;Hello World&quot;; ?&gt;</span>
<span style="color: #c20cb9; font-weight: bold;">vi</span> hello.php</pre></td></tr></table><p class="theCode" style="display:none;"># Just put a helloworld in the file like this &lt;?php echo &quot;Hello World&quot;; ?&gt;
vi hello.php</p></div>

<p>At this point we can make our initial commit, a vanilla un-installed Magento, and a heartbeat file.</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">git commit</span> <span style="color: #660033;">-m</span> <span style="color: #ff0000;">&quot;initial check-in&quot;</span></pre></td></tr></table><p class="theCode" style="display:none;">git commit -m &quot;initial check-in&quot;</p></div>

<p>Leave this Terminal window open, we&#8217;ll be back to it shortly, but now let&#8217;s set up the Beanstalk Application and Environment we&#8217;ll use for testing.</p>
<h3>Preparation of the Beanstalk Environment</h3>
<p>This part of the tutorial we&#8217;ll just be setting up the Sample app through the <a href="https://console.aws.amazon.com/elasticbeanstalk/home">Elastic Beanstalk web console</a>, so <a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_PHP.sdlc.html">follow the steps Amazon provides here</a>.</p>
<ul>
<li>When prompted create an RDS database server as part of the environment.</li>
<li>When setting up the load balancer choose the /hello.php file as the target</li>
</ul>
<p>Here&#8217;s a series of screenshots that should guide you through the setup. Note which name you use for your Application and Environment, you&#8217;ll need them in the next step.</p>
<p><img src="../../../../cdn.aschroder.com/wp-content/uploads/2013/04/1-application-details.png" alt="1-application-details" width="1336" height="958" class="aligncenter size-full wp-image-1991" srcset="http://cdn.aschroder.com/wp-content/uploads/2013/04/1-application-details.png 1336w, http://cdn.aschroder.com/wp-content/uploads/2013/04/1-application-details-300x215.png 300w, http://cdn.aschroder.com/wp-content/uploads/2013/04/1-application-details-1024x734.png 1024w" sizes="(max-width: 1336px) 100vw, 1336px" /></p>
<p><img src="../../../../cdn.aschroder.com/wp-content/uploads/2013/04/2-env-details.png" alt="2-env-details" width="1390" height="994" class="aligncenter size-full wp-image-1990" srcset="http://cdn.aschroder.com/wp-content/uploads/2013/04/2-env-details.png 1390w, http://cdn.aschroder.com/wp-content/uploads/2013/04/2-env-details-300x214.png 300w, http://cdn.aschroder.com/wp-content/uploads/2013/04/2-env-details-1024x732.png 1024w" sizes="(max-width: 1390px) 100vw, 1390px" /></p>
<p><img src="../../../../cdn.aschroder.com/wp-content/uploads/2013/04/3-config-details.png" alt="3-config-details" width="1338" height="862" class="aligncenter size-full wp-image-1992" srcset="http://cdn.aschroder.com/wp-content/uploads/2013/04/3-config-details.png 1338w, http://cdn.aschroder.com/wp-content/uploads/2013/04/3-config-details-300x193.png 300w, http://cdn.aschroder.com/wp-content/uploads/2013/04/3-config-details-1024x659.png 1024w" sizes="(max-width: 1338px) 100vw, 1338px" /></p>
<p><img src="../../../../cdn.aschroder.com/wp-content/uploads/2013/04/4-rds.png" alt="4-rds" width="1354" height="1126" class="aligncenter size-full wp-image-1989" srcset="http://cdn.aschroder.com/wp-content/uploads/2013/04/4-rds.png 1354w, http://cdn.aschroder.com/wp-content/uploads/2013/04/4-rds-300x249.png 300w, http://cdn.aschroder.com/wp-content/uploads/2013/04/4-rds-1024x851.png 1024w" sizes="(max-width: 1354px) 100vw, 1354px" /></p>
<p>Take note of the database credentials, you&#8217;ll need those for installation. Once created it&#8217;ll take a few minutes for the environment to start up. Note that the sample app will not actually go <em>green</em> because it doesn&#8217;t have the required heartbeat file hello.php. But it will once we deploy, read on.</p>
<h3>Deploy Magento and Install it</h3>
<p>In a normal production scenario, our Magento code would already be &#8216;installed&#8217; and have an <code>app/etc/local.xml</code> file filled with the MySQL connection info (and other environment configuration) before we deploy the code. In this case, to make things easy we&#8217;re just going to install Magento in the environment, which will run the setup scripts on the database and have it ready to use.</p>
<p>From the root of your Magento setup directory run these commands.</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># You'll need to enter your AWS credentials and your </span>
<span style="color: #666666; font-style: italic;"># Elastic beanstalk application/environment details</span>
<span style="color: #c20cb9; font-weight: bold;">git</span> aws.config
<span style="color: #666666; font-style: italic;"># This will push the latest code to your Beanstalk</span>
<span style="color: #c20cb9; font-weight: bold;">git</span> aws.push</pre></td></tr></table><p class="theCode" style="display:none;"># You'll need to enter your AWS credentials and your 
# Elastic beanstalk application/environment details
git aws.config
# This will push the latest code to your Beanstalk
git aws.push</p></div>

<p>That last step, the <code>git aws.push</code> is what deploys your code to the cluster. The upload will take a bit of time to send, once it has, you should see your Beanstalk environment version update in the web console to look like this. It should be green after it&#8217;s had time to deploy.</p>
<p><img src="../../../../cdn.aschroder.com/wp-content/uploads/2013/04/running-git-release.png" alt="running-git-release" width="1482" height="744" class="aligncenter size-full wp-image-1995" srcset="http://cdn.aschroder.com/wp-content/uploads/2013/04/running-git-release.png 1482w, http://cdn.aschroder.com/wp-content/uploads/2013/04/running-git-release-300x150.png 300w, http://cdn.aschroder.com/wp-content/uploads/2013/04/running-git-release-1024x514.png 1024w" sizes="(max-width: 1482px) 100vw, 1482px" /></p>
<p>If everything has gone to plan, when you browse to your beanstalk URL, you should see the Magento install screen like this. We&#8217;ll go ahead and do a normal install. </p>
<p><img src="../../../../cdn.aschroder.com/wp-content/uploads/2013/04/magento-install-screen.png" alt="magento-install-screen" width="1552" height="1146" class="aligncenter size-full wp-image-2000" srcset="http://cdn.aschroder.com/wp-content/uploads/2013/04/magento-install-screen.png 1552w, http://cdn.aschroder.com/wp-content/uploads/2013/04/magento-install-screen-300x221.png 300w, http://cdn.aschroder.com/wp-content/uploads/2013/04/magento-install-screen-1024x756.png 1024w" sizes="(max-width: 1552px) 100vw, 1552px" /></p>
<p>To get the database info for install, we&#8217;ll need to check the RDS control panel and input it.</p>
<p><img src="../../../../cdn.aschroder.com/wp-content/uploads/2013/04/rds-data.png" width="400" alt="rds-data" class="aligncenter size-full wp-image-1999" srcset="http://cdn.aschroder.com/wp-content/uploads/2013/04/rds-data.png 908w, http://cdn.aschroder.com/wp-content/uploads/2013/04/rds-data-300x274.png 300w" sizes="(max-width: 908px) 100vw, 908px" /></p>
<p>You need the database host, database name, database username and password.</p>
<p><img src="../../../../cdn.aschroder.com/wp-content/uploads/2013/04/input-rds-during-install.png" alt="input-rds-during-install" width="1442" height="1910" class="aligncenter size-full wp-image-1998" srcset="http://cdn.aschroder.com/wp-content/uploads/2013/04/input-rds-during-install.png 1442w, http://cdn.aschroder.com/wp-content/uploads/2013/04/input-rds-during-install-226x300.png 226w, http://cdn.aschroder.com/wp-content/uploads/2013/04/input-rds-during-install-773x1024.png 773w" sizes="(max-width: 1442px) 100vw, 1442px" /></p>
<p><em>Note: During install elect to keep sessions in the database.</em></p>
<p>Once installed, you should see the normal Magento home page and admin screen. But, the observant among you will note, that the changes made during install will not persist should our instance die and get replaced. We need to commit our newly created local.xml, so the installation configuration becomes part of our code base.</p>
<p>If you&#8217;re comfortable with creating local.xml files &#8211; you can just create one and commit it, if not, it&#8217;s easy to fetch it from your beanstalk instance &#8211; you can use the key you specified when creating the environment. Then commit it and push it as a new release.</p>

<div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># From the root of your magento setup directory</span>
<span style="color: #c20cb9; font-weight: bold;">scp</span> <span style="color: #660033;">-i</span> ~<span style="color: #000000; font-weight: bold;">/</span>path<span style="color: #000000; font-weight: bold;">/</span>to<span style="color: #000000; font-weight: bold;">/</span>your<span style="color: #000000; font-weight: bold;">/</span>key.pem ec2-user<span style="color: #000000; font-weight: bold;">@</span>your-ec2-server-ip.compute-<span style="color: #000000;">1</span>.amazonaws.com:<span style="color: #000000; font-weight: bold;">/</span>var<span style="color: #000000; font-weight: bold;">/</span>app<span style="color: #000000; font-weight: bold;">/</span>current<span style="color: #000000; font-weight: bold;">/</span>app<span style="color: #000000; font-weight: bold;">/</span>etc<span style="color: #000000; font-weight: bold;">/</span>local.xml app<span style="color: #000000; font-weight: bold;">/</span>etc<span style="color: #000000; font-weight: bold;">/</span>local.xml
<span style="color: #c20cb9; font-weight: bold;">git add</span> app<span style="color: #000000; font-weight: bold;">/</span>etc<span style="color: #000000; font-weight: bold;">/</span>local.xml
<span style="color: #c20cb9; font-weight: bold;">git commit</span> <span style="color: #660033;">-m</span> <span style="color: #ff0000;">&quot;Adding the installation config&quot;</span>
<span style="color: #c20cb9; font-weight: bold;">git</span> aws.push</pre></td></tr></table><p class="theCode" style="display:none;"># From the root of your magento setup directory
scp -i ~/path/to/your/key.pem ec2-user@your-ec2-server-ip.compute-1.amazonaws.com:/var/app/current/app/etc/local.xml app/etc/local.xml
git add app/etc/local.xml
git commit -m &quot;Adding the installation config&quot;
git aws.push</p></div>

<p>Once this release is loaded, your store should still be the same, but now your installation is part of your code. </p>
<p>If we were only running a single instance, we could stop here, but in a multi-instance cluster, this Magento store won&#8217;t work as the cache and media are instance local. Let&#8217;s get it cluster-ready.</p>
<h3>Configure Magento for Beanstalk Cluster</h3>
<p>There is unlimited scope for configuration here, we&#8217;ll just do the bare minimum to get a site running for now. The two main things are to ensure caching and media are shared by all nodes in the cluster to do that we need to update the configuration.</p>
<p>Create an <a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/AWSHowTo.ElastiCache.html">Amazon Elasticache memcached cluster with one or more nodes</a>, and note the node address(es). There&#8217;s a really important note about security groups on that page, I&#8217;m pasting it below for your benefit:</p>
<blockquote><p>Configure your Amazon ElastiCache Security Group to allow access from the Amazon EC2 security group used by your AWS Elastic Beanstalk application. For instructions on how to find the name of your EC2 security group using the AWS Management Console, see Amazon EC2 Security Groups. For more information, go to Authorize Access in the Amazon ElastiCache Getting Started Guide.</p></blockquote>
<p>What it means is that in order for your Beanstalk nodes to access the memcached nodes in Elasticache, you need to authorise the security group. The linked guide will show you how, but don&#8217;t forget, otherwise it&#8217;ll never connect.</p>
<p><strong>Update your configuration</strong><br />
In your local.xml add extra cache configuration &#8211; <a href="http://blog.nexcess.net/2010/12/13/configuring-memcached-in-magento-1-4/">Nexcess published a great guide</a>, or refer to the local.xml.additional file in <code>app/etc/</code>. In this basic setup we&#8217;ll just use the memcached node as the first layer fast cache, and the database as the second layer slow cache with tag support. </p>
<p>That option is one of many, <a href="http://colin.mollenhour.com/">Colin Mollenhour</a> did <a href="http://info.magento.com/rs/magentocommerce/images/imagine2012-tech-cache-showdown.pdf">an excellent presentation on caching</a> last year at Magento Imagine, it&#8217;s highly suggested you have a read of his slides. Redis would be a great backend option, but has an admin overhead which we&#8217;re trying to avoid in this setup.</p>
<p>It&#8217;s also worth changing the configuration to use memcached for the session storage, but not required.</p>
<p><em>Extra for experts:</em><br />
Elasticache uses clusters of memcached nodes, there are features in Elastic cache for node discovery, which would mean you could add and remove nodes and customize Magento to automatically detect and use new nodes. For now we&#8217;ll use static configuration.</p>
<p>Once you have made the changes to local.xml, you can commit them and push them as you did earlier. To force clear the existing cache, log onto the running beanstalk instance and delete the <code>var/cache</code> folder (and <code>var/session</code> if you configured it to use memcached). Because the cache files are not part of your git repository, you could also simply kill the EC2 server and start another &#8211; the configuration it uses will be the updated version.</p>
<p><strong>Update Media storage</strong><br />
To store media in a shared location, we could use NFS like I do in <a href="../../../2011/06/clustering-wordpress-on-amazon-ec2-micro-instances/index.html">my wordpress cluster guide</a>, but that would require maintenance of NFS server/client software, and the goal here is to keep things as stock-standard as possible. </p>
<p>Instead, we can use the built in Magento capability to store any media in the database. We could use a separate RDS server, but in this case we&#8217;ll just use the one that&#8217;s already running &#8211; the load should be minimal because the CDN will serve media for us.</p>
<p>This is a Magento configuration option as shown:</p>
<p><img src="../../../../cdn.aschroder.com/wp-content/uploads/2013/04/media-in-database.png" alt="media-in-database" class="aligncenter size-medium wp-image-2004" width="500" srcset="http://cdn.aschroder.com/wp-content/uploads/2013/04/media-in-database.png 1798w, http://cdn.aschroder.com/wp-content/uploads/2013/04/media-in-database-300x162.png 300w, http://cdn.aschroder.com/wp-content/uploads/2013/04/media-in-database-1024x555.png 1024w" sizes="(max-width: 1798px) 100vw, 1798px" /></p>
<p>And with that, we&#8217;re done, we have a bare-bones cluster running on a vanilla AWS Linux AMI and a vanilla Magento.</p>
<h3>More Advanced Configuration</h3>
<p>To complete this setup would take many more hours of work &#8211; you&#8217;ll <a href="../../../2011/05/magento-and-amazons-cloudfront-cdn-the-easy-way/index.html">need to configure a CDN</a> and setup an <a href="../../../2011/03/magento-amazon-simple-email-service-ses-added-to-smtp-pro-1-4-3/index.html">external email service such as Amazon SES</a>. You&#8217;ll also need to get cron running for a clustered environment, which would mean running it externally and calling the web facing /cron.php &#8211; to ensure it only runs once, and it&#8217;s load is evenly distributed.</p>
<p>For performance and efficiency it also pays to use some form of page caching. This could be a Magento specific extension (or enterprise edition feature) or could be one or more Varnish nodes placed in front of the ELB load balancer. Again that&#8217;s a whole separate book!</p>
<p>There&#8217;s surely going to be hundreds of things I have missed here too, so expect to do some debugging for yourself, but this should be a pretty good headstart.</p>
<h3>Benchmarks</h3>
<p>Will have to wait for another day sorry folks, this post turned out to be a monster.</p>
<p>Enjoy the Beanstalk and please comment with any feedback or errors.</p>
<div class='yarpp-related'>
<p>You might also be interested in:<ol>
<li><a href="../magento-and-aws-elastic-beanstalk-the-scalability-silver-bullet/index.html" rel="bookmark" title="Magento and AWS Elastic Beanstalk &#8211; The Scalability Silver Bullet?">Magento and AWS Elastic Beanstalk &#8211; The Scalability Silver Bullet? </a></li>
<li><a href="../../../2011/04/cloud-backup-case-study-detecting-if-magento-cron-is-running-in-your-extensions/index.html" rel="bookmark" title="Cloud Backup Case study: Detecting if Magento cron is running in your extensions">Cloud Backup Case study: Detecting if Magento cron is running in your extensions </a></li>
<li><a href="../../../2010/09/new-in-cloud-backup-platform-independent-magento-backups/index.html" rel="bookmark" title="New in Cloud Backup: Platform Independent Magento Backups">New in Cloud Backup: Platform Independent Magento Backups </a></li>
<li><a href="../../../2009/02/how-to-set-up-apache-virtual-hosting-on-mamp-for-magento/index.html" rel="bookmark" title="How to set up Apache Virtual hosting on MAMP for Magento">How to set up Apache Virtual hosting on MAMP for Magento </a></li>
<li><a href="../../../2012/01/using-aws-auto-scaling-with-an-elastic-load-balancer-cluster-on-ec2/index.html" rel="bookmark" title="Using AWS Auto Scaling with an Elastic Load Balancer cluster on EC2">Using AWS Auto Scaling with an Elastic Load Balancer cluster on EC2 </a></li>
</ol></p>
</div>
		</div><!-- .entry-content -->
		<nav id="post-navigation" class="navigation post-navigation" role="navigation" aria-label="Post Navigation"><span class="screen-reader-text">Post navigation</span><div class="nav-links"><div class="nav-previous"><a href="../magento-and-aws-elastic-beanstalk-the-scalability-silver-bullet/index.html" rel="prev">Magento and AWS Elastic Beanstalk &#8211; The Scalability Silver Bullet?</a></div><div class="nav-next"><a href="../understanding-and-detecting-magento-extension-clashes-or-conflicts/index.html" rel="next">Understanding and Detecting Magento Extension Clashes or Conflicts</a></div></div></nav>
<section id="comments" class="comments-area" aria-label="Post Comments">

			<h2 class="comments-title">
			2 thoughts on &ldquo;<span>Actually running Magento on Amazon&#8217;s Elastic Beanstalk Cloud platform</span>&rdquo;		</h2>

		
		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-10088">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/bb1b94ba0e5b26731d3eea3abd3a03c5?s=128&amp;d=mm&amp;r=g' srcset="http://2.gravatar.com/avatar/bb1b94ba0e5b26731d3eea3abd3a03c5?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn"><a href='http://www.codesprint.de/' rel='external nofollow' class='url'>Xandi</a></cite>			</div>
			
			<a href="index.html#comment-10088" class="comment-date">
				<time datetime="2013-04-18T14:00:56+00:00">April 18, 2013</time>			</a>
		</div>
				<div id="div-comment-10088" class="comment-content">
				<div class="comment-text">
		<p>Thank you for this great post.<br />
I&#8217;m hope your blogging further about the amazon cloud.</p>
<p>I&#8217;m looking forward to test our magento installation on a elastic beanstalk.</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-10289">
		<div class="comment-body">
		<div class="comment-meta commentmetadata">
			<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/fe9d2067fd141c6552e154f68a091832?s=128&amp;d=mm&amp;r=g' srcset="http://0.gravatar.com/avatar/fe9d2067fd141c6552e154f68a091832?s=256&amp;d=mm&amp;r=g 2x" class='avatar avatar-128 photo' height='128' width='128' />			<cite class="fn">Scott</cite>			</div>
			
			<a href="index.html#comment-10289" class="comment-date">
				<time datetime="2013-06-02T14:30:06+00:00">June 2, 2013</time>			</a>
		</div>
				<div id="div-comment-10289" class="comment-content">
				<div class="comment-text">
		<p>I&#8217;d be very interested in a follow-up to this post. I&#8217;m curious how to get the RDS credentials into the local.xml config file since the typical way to do this without checking your secrets into git is to use environment variables, but since magento reads these in via XML, I&#8217;m afraid we&#8217;d have to write some sort of custom script to download the xml file from an S3 bucket, make sure those files are secure and then provide the access credentials to the ec2 instance so it can fetch the file and copy it to the proper location upon deployment. I&#8217;m thinking you could set this up using a configuration file (inside a .elastibeanstalk/environment.config file) that would use the &#8220;sources&#8221; or &#8220;files&#8221; config options to do this automatically&#8230;</p>
		</div>
		<div class="reply">
						</div>
		</div>
				</div>
			</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

				<p class="no-comments">Comments are closed.</p>
	
</section><!-- #comments -->

</div><!-- #post-## -->

		</main><!-- #main -->
	</div><!-- #primary -->


		</div><!-- .col-full -->
	</div><!-- #content -->

	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="col-full">

					<div class="site-info">
			&copy; ASchroder.com 2023						<br /> Storefront designed by <a href="http://www.woocommerce.com/" title="WooCommerce - The Best eCommerce Platform for WordPress" rel="author">WooCommerce</a>.					</div><!-- .site-info -->
		
		</div><!-- .col-full -->
	</footer><!-- #colophon -->

	
</div><!-- #page -->

<link rel='stylesheet' id='yarppRelatedCss-css'  href='../../../wp-content/plugins/yet-another-related-posts-plugin/style/related101e.css?ver=4.8.15' type='text/css' media='all' />
<script type='text/javascript' src='../../../wp-content/plugins/wp-syntax/js/wp-syntax4963.js?ver=1.1'></script>
<script type='text/javascript' src='../../../../cdn.aschroder.com/wp-content/themes/storefront/assets/js/navigation.min11a8.js?ver=20120206'></script>
<script type='text/javascript' src='../../../../cdn.aschroder.com/wp-content/themes/storefront/assets/js/skip-link-focus-fix.min08e0.js?ver=20130115'></script>
<script type='text/javascript' src='../../../../cdn.aschroder.com/wp-includes/js/wp-embed.min101e.js?ver=4.8.15'></script>

</body>

<!-- Mirrored from www.aschroder.com/2013/04/actually-running-magento-on-amazons-elastic-beanstalk-cloud-platform/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 30 Aug 2023 22:28:57 GMT -->
</html>

<!-- Performance optimized by W3 Total Cache. Learn more: https://www.w3-edge.com/products/

Page Caching using disk
Content Delivery Network via cdn.aschroder.com

 Served from: www.aschroder.com @ 2023-08-30 14:18:58 by W3 Total Cache -->